<!DOCTYPE html>
<html lang="en">
<head>
         
  <script src="https://apis.google.com/js/platform.js" async defer></script>
  <meta name="google-signin-client_id" content="18229040173-c8cnia2v4jseslvf2j3j7m6vj8v2vbvk.apps.googleusercontent.com">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <script
  src="https://code.jquery.com/jquery-3.3.1.js"
  integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
  crossorigin="anonymous"></script>
  <title>Document</title>
  <link rel="stylesheet" href="style.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
</head>
<body>

         
  <div id="loginPage" class="container">
    <!-- <p id="choba"></p> -->
    <div class="formBox level-login">
      <div class="box boxShaddow"></div>
            
      <div class="box loginBox">
        <h2>LOGIN</h2>
        <form class="form">
          <div class="f_row">
            <label>Email</label>
            <input type="email" class="input-field" id="emailLogin" required>
            <u></u>
          </div>
            <div class="f_row last">
              <label>Password</label>
              <input type="password" class="input-field" id="passwordLogin" required>
              <u></u>
            </div>
            <button class="btn" onclick="login($(emailLogin).val(), $(passwordLogin).val())"><span>LOGIN</span><u></u>
              <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 415.582 415.582" xml:space="preserve">
                <path d="M411.47,96.426l-46.319-46.32c-5.482-5.482-14.371-5.482-19.853,0L152.348,243.058l-82.066-82.064
                    c-5.48-5.482-14.37-5.482-19.851,0l-46.319,46.32c-5.482,5.481-5.482,14.37,0,19.852l138.311,138.31
                    c2.741,2.742,6.334,4.112,9.926,4.112c3.593,0,7.186-1.37,9.926-4.112L411.47,116.277c2.633-2.632,4.111-6.203,4.111-9.925
                    C415.582,102.628,414.103,99.059,411.47,96.426z"/>
              </svg>
            </button>
        </form>
      </div>
             
      <div class="box registerBox">
        <span class="reg_bg"></span>
        <h2>Register</h2>
        <form class="form">
          <div class="f_row">
            <label>Username</label>
            <input type="text" class="input-field" id="nameRegister" required>
            <u></u>
          </div>
          <div class="f_row">
            <label>Email</label>
            <input type="email" class="input-field" id="emailRegister" required>
            <u></u>
          </div>
          <div class="f_row last">
            <label>Password</label>
            <input type="password" class="input-field" id="passwordRegister" required>
            <u></u>
          </div>
          <button class="btn-large" onclick="register($(nameRegister).val(), $(emailRegister).val(), $(passwordRegister).val())">REGISTER</button>
        </form>
      </div>
      <a href="#" class="regTag icon-add">
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 357 357" style="enable-background:new 0 0 357 357;" xml:space="preserve">
          <path d="M357,204H204v153h-51V204H0v-51h153V0h51v153h153V204z"/>
        </svg>
      </a>
      
    </div>
  </div>
    
  <div id="mainPage">

    <div id="sideBarNav">
      <ul class="sidebar">
        <li class="sidebar-brand" style="font-size: 30px;"><a >Todo</a></li>
        <li><a onclick="pressTodo()">Add Todo</a></li>
        <li><a onclick="pressList()">My List</a></li>
        <li><a >My Incompleted List</a></li>
        <li><a >My Completed List</a></li>
        <li><a >My Groups</a></li>
        <li><a onclick="exit()">Logout</a></li>
      </ul>
    </div>

    <div id="mainBox" class="mainBox-css">

      <div id="allTaskList">

          <svg viewBox="0 0 0 0" style="position: absolute; z-index: -1; opacity: 0;">
              <defs>
                <linearGradient id="boxGradient" gradientUnits="userSpaceOnUse" x1="0" y1="0" x2="25" y2="25">
                  <stop offset="0%"   stop-color="#27FDC7"/>
                  <stop offset="100%" stop-color="#0FC0F5"/>
                </linearGradient>
            
                <linearGradient id="lineGradient">
                  <stop offset="0%"    stop-color="#0FC0F5"/>
                  <stop offset="100%"  stop-color="#27FDC7"/>
                </linearGradient>
            
                <path id="todo__line" stroke="url(#lineGradient)" d="M21 12.3h168v0.1z"></path>
                <path id="todo__box" stroke="url(#boxGradient)" d="M21 12.7v5c0 1.3-1 2.3-2.3 2.3H8.3C7 20 6 19 6 17.7V7.3C6 6 7 5 8.3 5h10.4C20 5 21 6 21 7.3v5.4"></path>
                <path id="todo__check" stroke="url(#boxGradient)" d="M10 13l2 2 5-5"></path>
                <circle id="todo__circle" cx="13.5" cy="12.5" r="10"></circle>
              </defs>
            </svg>
            
            
            <div class="todo-list"  id="allTodoTask">
              
    
              
                
            
              
          </div>

      </div>
      


      <div id="createTodo" class="container">
          <!-- <p id="choba"></p> -->
          <div class="formBox level-login">
            <div class="box boxShaddow"></div>
                  
            <div class="box loginBox">
              <h2>Create Todo</h2>
              <form class="form">
                <div class="f_row">
                  <label>Title</label>
                  <input type="text" class="input-field" id="titleInput" required>
                  <u></u>
                </div>
                <div class="f_row last">
                  <label>About</label>
                  <input type="text" class="input-field" id="aboutInput" required>
                  <u></u>
                </div>
                <div class="f_row last">
                  <label>Due date</label>
                  <input type="date" class="input-field" id="dateInput" required>
                  <u></u>
                </div>
                <button class="btn" onclick="createTodo($('#titleInput').val(),$('#aboutInput').val(), $('#dateInput').val())"><span>Create</span><u></u>
                  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 415.582 415.582" xml:space="preserve">
                    <path d="M411.47,96.426l-46.319-46.32c-5.482-5.482-14.371-5.482-19.853,0L152.348,243.058l-82.066-82.064
                        c-5.48-5.482-14.37-5.482-19.851,0l-46.319,46.32c-5.482,5.481-5.482,14.37,0,19.852l138.311,138.31
                        c2.741,2.742,6.334,4.112,9.926,4.112c3.593,0,7.186-1.37,9.926-4.112L411.47,116.277c2.633-2.632,4.111-6.203,4.111-9.925
                        C415.582,102.628,414.103,99.059,411.47,96.426z"/>
                  </svg>
                </button>
                
              </form>
            </div>
                   
            
          </div>
        </div>

      
      
    </div>

  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

  <script>

    // const tokenExists = localStorage.getItem('token')
    // if(token) {
    //   console.log('ada');
      
    //   $('#loginPage').hide()
    // }

    $('#mainPage').hide()
    $('#createTodo').hide()
    showAllTodo()


    const inP = $('.input-field');

    inP.on('blur', function () {
        if (!this.value) {
            $(this).parent('.f_row').removeClass('focus');
        } else {
            $(this).parent('.f_row').addClass('focus');
        }
    }).on('focus', function () {
        $(this).parent('.f_row').addClass('focus');
        $('.btn').removeClass('active');
        $('.f_row').removeClass('shake');
    });


    // $('.resetTag').click(function(e){
    //     e.preventDefault();
    //     $('.formBox').addClass('level-forget').removeClass('level-reg');
    // });

    // $('.back').click(function(e){
    //     e.preventDefault();
    //     $('.formBox').removeClass('level-forget').addClass('level-login');
    // });



    $('.regTag').click(function(e){
        e.preventDefault();
        $('.formBox').removeClass('level-reg-revers');
        $('.formBox').toggleClass('level-login').toggleClass('level-reg');
        if(!$('.formBox').hasClass('level-reg')) {
            $('.formBox').addClass('level-reg-revers');
        }
    });

    $('.btn').each(function() {
        $(this).on('click', function(e){
            e.preventDefault();
            let finp =  $(this).parent('form').find('input');
        
            console.log(finp.html());
        
            if (!finp.val() == 0) {
                $(this).addClass('active');
            }
            
            setTimeout(function () {
                
                inP.val('');
                
                $('.f_row').removeClass('shake focus');
                $('.btn').removeClass('active');
                
            }, 2000);
            
            if(inP.val() == 0) {
                inP.parent('.f_row').addClass('shake');
            }
            
            //inP.val('');
            //$('.f_row').removeClass('focus');
            
        });
    });



    console.clear();

    setTimeout(function(){
      document.querySelector('input[type="checkbox"]').setAttribute('checked',true);
    },100);



    function register(inputName, inputEmail, inputPassword) {

      console.log('ini loh data nya register', inputName, inputEmail, inputPassword);
      
      $.ajax({
        method: 'POST',
        url: `http://localhost:3000/register`,
        data: {
            name: inputName,
            email: inputEmail,
            password: inputPassword
        }
      })
        .done(result => {
          console.log('Registered Successfully');
          
          
        })
        .fail(err => {
          console.log(err);
            
        })
    }

    function login(inputEmail, inputPassword) {

      console.log('ini loh data nya login', inputEmail, inputPassword);

      $.ajax({
        method: 'POST',
        url: `http://localhost:3000/login`,
        data: {
            email: inputEmail,
            password: inputPassword
        }
      })
        .done(result => {
          console.log('Logged in Successfully', result)
          localStorage.setItem('token', result.token)
          $('#loginPage').hide()
          $('#mainPage').show()

        })
        .fail(err => {
          console.log(err);
            
        })
    }

    function exit() {
      localStorage.removeItem('token')
      $('#loginPage').show()
      $('#mainPage').hide()
    }


    function pressTodo() {
      $('#allTaskList').hide()
      $('#createTodo').show()
    }
    function pressList() {
      $('#allTaskList').show()
      $('#createTodo').hide()
      $('#allTodoTask').empty()
      showAllTodo()
    }

    function createTodo(inputTitle, inputAbout, inputDueDate) {
      
      $.ajax({
        method: 'POST',
        url: `http://localhost:3000/todo`,
        data: {
          title: inputTitle,
          about: inputAbout,
          due_date: inputDueDate
        },
        headers: {
          token: localStorage.getItem('token')
        }
      })
        .done(result => {
          console.log('Create todo Successfully', result)
          $('#allTaskList').hide()
          $('#createTodo').show()



        })
        .fail(err => {
          console.log(err);
            
        })

    }

    function showAllTodo() {
      $.ajax({
        method: 'GET',
        url: `http://localhost:3000/todo`,
        headers: {
          token: localStorage.getItem('token')
        }
      })
        .done(result => {
          console.log('Show todo Successfully', result)
          let tasks = result.data

          for (let i = 0; i < tasks.length; i++) {

            $('#allTodoTask').append(


              `
              <label class="todo">
                <input class="todo__state" type="checkbox" />
                
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 200 25" class="todo__icon">
                  <use xlink:href="#todo__line" class="todo__line"></use>
                  <use xlink:href="#todo__box" class="todo__box"></use>
                  <use xlink:href="#todo__check" class="todo__check"></use>
                  <use xlink:href="#todo__circle" class="todo__circle"></use>
                </svg>
                <div class="todo__text">${tasks[i].title}</div>
                <div class="todo__text">${tasks[i].about}</div>
                
              </label>

              `


            )

          }
          
          

          

        })
        .fail(err => {
          console.log(err);
            
        })
    }

</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</body>
</html>